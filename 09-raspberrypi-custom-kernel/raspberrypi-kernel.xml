<ns0:RootFileSystem xmlns:ns0="https://www.linutronix.de/projects/Elbe" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" created="2009-05-20T08:50:56" revision="6" xsi:schemaLocation="https://www.linutronix.de/projects/Elbe dbsfed.xsd">
<project>
<name>rpi-image</name>
<version>1.0</version>
<description>
    Raspberry Pi Boot image
</description>
<buildtype>aarch64</buildtype>
<mirror>
 <primary_host>ftp.de.debian.org</primary_host>
 <primary_path>/debian</primary_path>
 <primary_proto>http</primary_proto>
 <url-list>
  <url>
    <binary>http://deb.debian.org/debian-security trixie-security main</binary>
    <source>http://deb.debian.org/debian-security trixie-security main</source>
  </url>
  <url>
    <binary>http://deb.debian.org/debian trixie non-free-firmware</binary>
    <source>http://deb.debian.org/debian trixie non-free-firmware</source>
  </url>
  <url>
    <binary>http://deb.debian.org/debian-security trixie-security non-free-firmware</binary>
    <source>http://deb.debian.org/debian-security trixie-security non-free-firmware</source>
  </url>
 </url-list>
</mirror>
<suite>trixie</suite>
</project>
<target>
<hostname>rpi64</hostname>
<domain></domain>
<passwd_hashed>$6$bOQ4Sf4rSdI1IfRd$3Hai04jz2OYEW108SZWeweGO/rGvO65ITthDDtDuaC/8Gpwek/xT4rUvKBkBHFIjTDd6.klFdNJ685kxgabHh/</passwd_hashed>
<console>serial0,115200</console>
<package>
  <tar>
   <name>image.tgz</name>
  </tar>
</package>
 <debootstrap>
  <variant>minbase</variant>
  <include>gpgv</include>
 </debootstrap>

<images>
 <msdoshd>
  <name>sdcard.img</name>
  <size>2GB</size>
  <partition>
    <size>556MB</size>
    <label>firmware</label>
  </partition>
  <partition>
   <size>remain</size>
    <label>root</label>
    <bootable/>
  </partition>
 </msdoshd>
</images>
<fstab>
 <bylabel>
  <label>firmware</label>
  <mountpoint>/boot/firmware</mountpoint>
  <fs>
      <type>vfat</type>
  </fs>
 </bylabel>
 <bylabel>
  <label>root</label>
  <mountpoint>/</mountpoint>
  <fs>
    <type>ext4</type>
    <fs-finetuning>
       <device-command>tune2fs -O ^64bit,^metadata_csum -i 0 {device}</device-command>
    </fs-finetuning>
  </fs>

 </bylabel>
</fstab>
<install-recommends/>
<pkg-list>
 <pkg>linux-image-6.6.78-v8-16k-v8</pkg>
 <pkg>kmod</pkg>
 <pkg>initramfs-tools</pkg>
 <pkg>linux-base</pkg>
 <pkg>firmware-brcm80211</pkg>
 <pkg>firmware-misc-nonfree</pkg>
 <pkg>firmware-atheros</pkg>
 <pkg>firmware-libertas</pkg>
 <pkg>firmware-linux-free</pkg>
 <pkg>firmware-misc-nonfree</pkg>
 <pkg>firmware-realtek</pkg>
 <pkg>raspi-firmware</pkg>
 <pkg>zstd</pkg>
 <pkg>apt-utils</pkg>
 <pkg>systemd</pkg>
 <pkg>systemd-resolved</pkg>
 <pkg>systemd-timesyncd</pkg>
 <pkg>vim-tiny</pkg>
 <pkg>busybox</pkg>
 <pkg>bash</pkg>
 <pkg>dialog</pkg>
 <pkg>openssh-server</pkg>
 <pkg>wpasupplicant</pkg>
 <pkg>iproute2</pkg>
 <pkg>net-tools</pkg>
 <pkg>iputils-ping</pkg>
 <pkg>iw</pkg>
 <pkg>ifupdown</pkg>
 <pkg>bluez</pkg>
 <pkg>bluez-tools</pkg>
 <pkg>rfkill</pkg>
 <pkg>avahi-daemon</pkg>
 <pkg>avahi-utils</pkg>
          
</pkg-list>
<project-finetuning>
    <set_packer packer="tarxz">sdcard.img</set_packer>
</project-finetuning>
<finetuning>

 <command>echo 'ROOTPART="LABEL=root"' &gt;&gt; /etc/default/raspi-firmware</command>
 <command>echo 'KERNEL_ARCH="arm64"' &gt;&gt; /etc/default/raspi-firmware</command>
 <command>echo 'init=/usr/lib/systemd/systemd' &gt;&gt; /etc/default/raspi-extra-cmdline</command>
 <command>mkdir -p /boot/firmware</command>
 <command>cp /usr/lib/raspi-firmware/* /boot/firmware/</command>
 <command>cp -a /usr/lib/linux-image-6.6.78-v8-16k-v8/overlays/  /boot/firmware</command>
 <command>cp -a /usr/lib/linux-image-6.6.78-v8-16k-v8/broadcom/*  /boot/firmware</command>
 <command>cp  /boot/vmlinuz-6.6.78-v8-16k-v8  /boot/firmware</command>
 <command>mkinitramfs -o /boot/initrd.img-6.6.78-v8-16k-v8 6.6.78-v8-16k-v8</command>
 
 <file dst="/etc/systemd/network/25-wlan0.network" mode="644">
     [Match]
     Name=wlan0

     [Network]
     DHCP=yes

 </file>
 <file dst="/etc/wpa_supplicant/wpa_supplicant-wlan0.conf" mode="600">
  ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
  update_config=1
  country=US

  network={
      ssid=" SomeSSID"
      psk=" SomeKey"
  }
      </file>
 le dst="/etc/default/raspi-firmware" append="true" >
  ROOTPART="LABEL=root"
  KERNEL_ARCH="arm64"
      </file>

 <file dst="/etc/default/raspi-extra-cmdline" append="true">
   init=/usr/lib/systemd/systemd
 </file>

 <command>update-initramfs -u -k all</command>
 <command>systemctl enable wpa_supplicant@wlan0.service</command>
 <command>systemctl enable systemd-networkd</command>
 <command>systemctl enable avahi-daemon</command>
 <file dst="/boot/firmware/cmdline.txt" mode="777">              
     earlyprintk console=ttyAMA0,115200 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 fsck.repair=yes rootwait cfg80211.ieee80211_regdom=GB  init=/usr/lib/systemd/systemd
 </file> 
 <file dst="/boot/firmware/config.txt" mode="777">
   enable_uart=1
   arm_64bit=1
   dtoverlay=
   dtoverlay=disable-bt
   dtoverlay=uart0
   dtparam=uart0
   kernel=vmlinuz-6.6.78-v8-16k-v8
   initramfs initrd.img-6.6.78-v8-16k-v8
 </file>

</finetuning>
</target>
<archivedir>overlays/</archivedir>
</ns0:RootFileSystem>
